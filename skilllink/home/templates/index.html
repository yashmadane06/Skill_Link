{% extends "base.html" %}
{% load static %}

{% block title %}Home - SkillLink{% endblock %}

{% block content %}


<!-- HERO -->
<section id="hero" class="d-flex justify-content-center align-items-center py-5">
  <div class="hero-card text-center shadow-lg rounded-5 overflow-hidden position-relative">
    
    <!-- Background Image -->
    <img src="https://res.cloudinary.com/dctwxqpeo/image/upload/v1757867835/hero_image_en4boc.png"
         alt="SkillLink Hero"
         class="img-fluid hero-bg">

    <!-- Overlay -->
    <div class="hero-content position-absolute top-50 start-50 translate-middle text-white px-4">
      <p class="small fw-semibold text-uppercase mb-2">SkillLink</p>
      <h1 class="fw-bold display-5 hero-title mb-3">Learn. Teach. Exchange.</h1>
      <p class="lead mb-4">Peer-to-peer skill sharing platform.</p>
      <div class="d-flex flex-column flex-sm-row justify-content-center gap-3">
        <a href="#trending-skills" class="btn btn-warning fw-bold px-4 py-2 rounded-pill shadow-sm">Explore SkillLink</a>
        <a href="#about-team" class="btn btn-light fw-semibold px-4 py-2 rounded-pill shadow-sm">Know More</a>
      </div>
    </div>

  </div>
</section>

<style>
/* Container */
#hero {
  background: linear-gradient(180deg, #f9f9f9 0%, #f3f3f3 100%);
}

/* Hero Card */
.hero-card {
  width: 100%;
  max-width: 850px;
  aspect-ratio: 16 / 9;
  position: relative;
  background: #000;
  border-radius: 30px;
}

/* Background Image */
.hero-bg {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: inherit;
  filter: brightness(0.8);
}

/* Overlay Content */
.hero-content {
  width: 90%;
  max-width: 700px;
  text-shadow: 2px 2px 10px rgba(0,0,0,0.7);
}

/* Text styling */
.hero-title {
  font-size: 2.8rem;
  font-weight: 800;
}
.hero-content p.lead {
  font-size: 1.15rem;
  color: #f1f1f1;
}

/* Buttons */
.hero-content .btn {
  transition: all 0.3s ease;
  border: none;
}
.hero-content .btn-warning {
  background-color: #ffcc33;
  color: #000;
}
.hero-content .btn-warning:hover {
  background-color: #f1b800;
  transform: translateY(-3px);
}
.hero-content .btn-light {
  background: #fff;
  color: #111;
}
.hero-content .btn-light:hover {
  background: #f8f9fa;
  transform: translateY(-3px);
}

/* Responsiveness */
@media (max-width: 992px) {
  .hero-title {
    font-size: 2.2rem;
  }
  .hero-content p.lead {
    font-size: 1rem;
  }
}
@media (max-width: 768px) {
  .hero-card {
    aspect-ratio: 4 / 3;
  }
  .hero-title {
    font-size: 1.8rem;
  }
}
@media (max-width: 576px) {
  .hero-card {
    border-radius: 20px;
  }
  .hero-content {
    width: 95%;
  }
  .hero-title {
    font-size: 1.6rem;
  }
  .hero-content .btn {
    width: 100%;
    font-size: 0.95rem;
  }
}
</style>


<!-- Trending Skills -->
<section id="trending-skills" class="skills-section py-5">
  <div class="container">
    <h2 class="text-center mb-4 text-theme">Trending Skills</h2>

    <div class="row g-4 justify-content-center">
      {# NOTE: Use a pre-flattened list `trending_cards` from the view (each item = {'skill': skill, 'provider': provider}) #}
      {% for card in trending_cards %}
        <div class="col-12 col-md-6 col-lg-4">
          <div class="skill-card shadow-sm h-100 position-relative overflow-hidden">

            <!-- Skill Image -->
            <div class="skill-img-wrapper d-flex align-items-center justify-content-center">
              {% if card.skill.skill_icon %}
                <img src="{{ card.skill.skill_icon }}" alt="{{ card.skill.name }}">
              {% else %}
                <img src="https://via.placeholder.com/120.png?text={{ card.skill.name|urlencode }}" alt="{{ card.skill.name }}">
              {% endif %}

              <div class="skill-hover-overlay d-flex align-items-center justify-content-center">
                <a href="{% url 'create_booking' card.skill.id card.provider.profile.id %}" class="btn btn-theme btn-sm fw-bold">Send Request</a>
              </div>
            </div>

            <div class="card-body text-center p-3">
              <div class="d-flex align-items-center justify-content-center mb-2">
                {% if card.provider.profile.profile_pic %}
                  {# If it's an ImageField, use .url; otherwise fall back to the value itself #}
                  {% if card.provider.profile.profile_pic.url %}
                    <img src="{{ card.provider.profile.profile_pic.url }}" 
                         class="rounded-circle me-2" 
                         alt="Tutor Pic" 
                         style="width:30px; height:30px; object-fit:cover;">
                  {% else %}
                    <img src="{{ card.provider.profile.profile_pic }}" 
                         class="rounded-circle me-2" 
                         alt="Tutor Pic" 
                         style="width:30px; height:30px; object-fit:cover;">
                  {% endif %}
                {% else %}
                  <div class="rounded-circle bg-theme text-white fw-bold d-flex align-items-center justify-content-center me-2" 
                       style="width:30px; height:30px; font-size:0.75rem;">
                      {{ card.provider.profile.user.first_name|slice:":1" }}
                  </div>
                {% endif %}
                <h6 class="fw-bold mb-0 username">{{ card.provider.profile.user.username }}</h6>
              </div>

              <p class="skill-name">{{ card.skill.name }}</p>
            </div>
          </div>
        </div>
      {% endfor %}

      <!-- Explore More Card -->
      <div class="col-12 col-md-6 col-lg-4">
        <div class="skill-card explore-card shadow-sm h-100 d-flex align-items-center justify-content-center">
          <h6 class="fw-bold mb-0">
            <a href="{% url 'skill_list' %}" class="text-white text-decoration-none">+ Explore More</a>
          </h6>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
/* === TRENDING SKILLS SECTION === */
.skills-section {
  background: var(--bg-light, #fffdf5);
  transition: background 0.4s ease, color 0.4s ease;
}

/* Title */
.text-theme {
  color: #d4af37;
  font-weight: 700;
  letter-spacing: 1px;
}

/* Skill Card */
.skill-card {
  background: #ffffff;
  border-radius: 15px;
  overflow: hidden;
  transition: transform 0.4s ease, box-shadow 0.4s ease;
  cursor: pointer;
  position: relative;
  font-family: 'Poppins', sans-serif;
}

.skill-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 12px 28px rgba(0, 0, 0, 0.15);
}

/* Skill Image */
.skill-img-wrapper {
  width: 100%;
  height: 160px;
  overflow: hidden;
  position: relative;
}

.skill-img-wrapper img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
}

.skill-card:hover .skill-img-wrapper img {
  transform: scale(1.08);
}

/* Overlay on Hover */
.skill-hover-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255, 215, 0, 0.4);
  opacity: 0;
  transition: opacity 0.4s ease;
}

.skill-card:hover .skill-hover-overlay {
  opacity: 1;
}

/* Skill Info */
.card-body {
  background: #fffef7;
  transition: background 0.4s ease;
}

.username {
  font-size: 0.9rem;
  color: #222;
}

.skill-name {
  color: #666;
  font-size: 0.85rem;
}

/* Theme Buttons */
.btn-theme {
  background: #d4af37;
  color: #222;
  border: none;
  transition: all 0.3s ease;
}

.btn-theme:hover {
  background: #e6b800;
  color: #111;
  transform: scale(1.05);
}

/* Explore Card */
.explore-card {
  background: #d4af37;
  border-radius: 15px;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.explore-card:hover {
  transform: scale(1.05);
  box-shadow: 0 8px 18px rgba(0, 0, 0, 0.2);
}

/* === DARK MODE === */
.dark-mode .skills-section {
  background: #121212;
}

.dark-mode .text-theme {
  color: #ffcf33;
}

.dark-mode .skill-card {
  background: #1e1e1e;
  box-shadow: 0 6px 14px rgba(255, 255, 255, 0.05);
}

.dark-mode .skill-name,
.dark-mode .username {
  color: #ccc;
}

.dark-mode .card-body {
  background: #1b1b1b;
}

.dark-mode .skill-hover-overlay {
  background: rgba(255, 215, 0, 0.15);
}

.dark-mode .explore-card {
  background: #ffcf33;
  color: #1e1e1e;
}

/* === RESPONSIVE === */
@media (max-width: 992px) {
  .skill-img-wrapper {
    height: 140px;
  }
}

@media (max-width: 576px) {
  .skill-img-wrapper {
    height: 120px;
  }
  .username {
    font-size: 0.85rem;
  }
  .skill-name {
    font-size: 0.8rem;
  }
}

/* Helper hidden class used by JS */
.hidden {
  display: none !important;
  visibility: hidden !important;
}
</style>



<!-- Reviews Section -->
<section class="container my-5 testimonial-section">
  <h2 class="mb-4 text-center fw-bold section-title">What Our Users Say</h2>
  <div class="row justify-content-center">
    {% for review in reviews %}
      <div class="col-12 col-sm-6 col-lg-4 mb-4">
        <div class="card review-card shadow-sm p-4 h-100 position-relative overflow-hidden fade-in">
          <div class="d-flex align-items-center mb-3">
            {% if review.profile_pic %}
              {% if review.profile_pic.url %}
                <img src="{{ review.profile_pic.url }}" 
                     class="rounded-circle me-3 border border-warning shadow-sm reviewer-pic" 
                     alt="User Pic"
                     style="width:60px; height:60px; object-fit:cover;">
              {% else %}
                <img src="{{ review.profile_pic }}" 
                     class="rounded-circle me-3 border border-warning shadow-sm reviewer-pic" 
                     alt="User Pic"
                     style="width:60px; height:60px; object-fit:cover;">
              {% endif %}
            {% else %}
              <img src="https://via.placeholder.com/60.png?text=User" 
                   class="rounded-circle me-3 border border-warning shadow-sm reviewer-pic" 
                   alt="User Pic"
                   style="width:60px; height:60px; object-fit:cover;">
            {% endif %}
            
            <div>
              <h6 class="fw-bold mb-0 reviewer-name">{{ review.name }}</h6>
              <small class="text-muted reviewer-role">{{ review.role|default:"SkillLink User" }}</small>
            </div>
          </div>

          <p class="review-text mb-0">‚Äú{{ review.text }}‚Äù</p>
        </div>
      </div>
    {% endfor %}
  </div>
</section>


<style>
/* ========== GENERAL THEME ========== */
.testimonial-section {
  font-family: 'Poppins', sans-serif;
}

.section-title {
  color: #222;
  letter-spacing: 0.5px;
  text-transform: uppercase;
}

/* ========== CARD STYLING ========== */
.review-card {
  background: linear-gradient(135deg, #fffdf2, #fefaf1);
  border-radius: 18px;
  border: none;
  transition: all 0.4s ease;
}
.review-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 18px 38px rgba(0, 0, 0, 0.15);
}

/* Reviewer image */
.reviewer-pic {
  transition: transform 0.3s ease;
}
.review-card:hover .reviewer-pic {
  transform: scale(1.05);
}

/* Reviewer text */
.reviewer-name {
  color: #111;
  font-weight: 600;
}
.reviewer-role {
  font-size: 0.85rem;
  color: #777;
}
.review-text {
  font-size: 0.95rem;
  color: #555;
  line-height: 1.6;
  font-style: italic;
}

/* ========== RESPONSIVE ========== */
@media (max-width: 768px) {
  .review-card { padding: 1.5rem; }
  .review-text { font-size: 0.9rem; }
  .section-title { font-size: 1.5rem; }
}
@media (max-width: 480px) {
  .reviewer-pic { width: 50px; height: 50px; }
  .review-text { font-size: 0.85rem; }
  .reviewer-name { font-size: 1rem; }
}

/* ========== DARK MODE ========== */
body.dark-mode .review-card {
  background: linear-gradient(135deg, #1a1a1a, #262626);
  color: #f1f1f1;
  box-shadow: 0 10px 20px rgba(255, 215, 0, 0.05);
}
body.dark-mode .section-title {
  color: #f9f9f9;
}
body.dark-mode .review-text {
  color: #ddd;
}
body.dark-mode .reviewer-name {
  color: #fff;
}
body.dark-mode .reviewer-role {
  color: rgb(120 122 125 / 75%) !important;
}
body.dark-mode .review-card:hover {
  box-shadow: 0 20px 40px rgba(255, 215, 0, 0.2);
}

/* ========== FADE-IN ANIMATION ========== */
.fade-in {
  opacity: 0;
  transform: translateY(40px);
  transition: opacity 0.8s ease-out, transform 0.8s ease-out;
}
.fade-in.visible {
  opacity: 1;
  transform: translateY(0);
}
</style>

<script>
// Fade-in animation on scroll - guarded
(function() {
  const fadeEls = document.querySelectorAll('.fade-in');
  if (fadeEls.length && 'IntersectionObserver' in window) {
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, { threshold: 0.2 });

    fadeEls.forEach(el => observer.observe(el));
  } else {
    // If no IntersectionObserver, reveal all as fallback
    fadeEls.forEach(el => el.classList.add('visible'));
  }
})();
</script>


<!-- Team Section (unchanged) -->
<section id="about-team" class="team-section py-5">
  <div class="container text-center">
    <!-- Group Photo -->
    <div id="group-photo" class="group-photo mb-5 position-relative overflow-hidden rounded-4 shadow">
      <img src="https://res.cloudinary.com/dctwxqpeo/image/upload/v1757867484/Team_Photos_sznfui.jpg" 
           alt="Group Photo" class="img-fluid rounded-4 shadow-lg w-100 group-img">
      <div class="overlay position-absolute top-50 start-50 translate-middle text-white p-4 rounded text-center">
  <h2 class="fw-bold mb-2 display-6 display-md-5">Meet the SkillLink Team</h2>
  <p class="mb-0 fs-6 fs-md-5">
    A passionate group of developers, designers, and innovators dedicated to creating a platform 
    where skills are shared, knowledge is exchanged, and learning never stops.
  </p>
</div>

    </div>

    <!-- Team Members -->
    <h3 class="text-center mb-4 text-theme">Our Team Members</h3>
    <div class="row justify-content-center g-4">
      {% for member in team %}
        <div class="{% if forloop.counter <= 3 %}col-md-4 col-sm-6{% else %}col-md-6 col-sm-6{% endif %}">
          <div class="team-card shadow-lg">
            <div class="inner">
              <!-- Front -->
              <div class="front d-flex flex-column align-items-center justify-content-center p-3">
                <img src="{{ member.image }}" class="rounded-circle mb-2 border border-3 border-warning" 
                     style="width:90px; height:90px; object-fit:cover;">
                <h5 class="fw-bold mb-1 text-theme">{{ member.name }}</h5>
                <p class="text-muted mb-0">{{ member.role }}</p>
              </div>
              <!-- Back -->
              <div class="back d-flex flex-column align-items-center justify-content-center p-3">
                <p class="mb-2 fw-semibold text-warning">üìû Connect With</p>
                <div>
                  <a href="{{ member.social.instagram }}" target="_blank" class="social-link me-3">Instagram</a>
                  <a href="{{ member.social.linkedin }}" target="_blank" class="social-link me-3">LinkedIn</a>
                  <a href="{{ member.social.github }}" target="_blank" class="social-link">GitHub</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</section>

<style>
/* Theme Variables */
:root {
  --bg-color: #f9f7f3;
  --text-color: #222;
  --accent: #ffb703;
  --accent-dark: #fb8500;
  --card-bg: #ffffff;
  --shadow: rgba(0, 0, 0, 0.15);
}

body.dark-mode {
  --bg-color: #0f0f0f;
  --text-color: #f5f5f5;
  --card-bg: #1a1a1a;
  --shadow: rgba(255, 255, 255, 0.05);
}

/* Section Base */
.team-section {
  background: var(--bg-color);
  color: var(--text-color);
  transition: background 0.4s ease, color 0.4s ease;
}

/* Group Photo */
.group-photo {
  position: relative;
  border-radius: 20px;
  overflow: hidden;
}
.group-img {
  transition: transform 0.6s ease;
}
.group-photo:hover .group-img {
  transform: scale(1.05);
}
.overlay {
  background: rgba(0, 0, 0, 0.55);
  backdrop-filter: blur(4px);
  transition: opacity 0.4s ease;
}

/* Team Card */
.team-card {
  perspective: 1000px;
  border-radius: 15px;
}
.team-card .inner {
  position: relative;
  width: 100%;
  height: 250px;
  transform-style: preserve-3d;
  transition: transform 0.8s ease;
  border-radius: 15px;
}
.team-card:hover .inner {
  transform: rotateY(180deg);
}
.front, .back {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  border-radius: 15px;
  background: var(--card-bg);
  box-shadow: 0 6px 20px var(--shadow);
  transition: background 0.4s ease;
}
.front {
  color: var(--text-color);
}
.back {
  background: var(--accent-dark);
  transform: rotateY(180deg);
  color: #fff;
}

/* Social Links */
.social-link {
  color: #fff;
  text-decoration: none;
  font-weight: 500;
  transition: color 0.3s ease, transform 0.2s ease;
}
.social-link:hover {
  color: var(--accent);
  transform: scale(1.1);
}

/* Text Theme */
.text-theme {
  color: var(--accent-dark);
}

/* Responsive */
@media (max-width: 768px) {
  .inner {
    height: 220px;
  }
}
@media (max-width: 576px) {
  .inner {
    height: 200px;
  }
}
/* Overlay base style */
.overlay {
  background: rgba(0, 0, 0, 0.55);
  max-width: 700px;
  width: 90%;
  backdrop-filter: blur(6px);
  border-radius: 1rem;
  transition: all 0.3s ease;
}

/* Text styling */
.overlay h2 {
  font-size: 2rem;
  line-height: 1.3;
}

.overlay p {
  font-size: 1rem;
  opacity: 0.9;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .overlay {
    top: 55%;
    padding: 1.25rem;
    width: 95%;
  }

  .overlay h2 {
    font-size: 1.4rem;
  }

  .overlay p {
    font-size: 0.9rem;
  }
}

@media (max-width: 480px) {
  .overlay {
    top: 60%;
    padding: 1rem;
  }

  .overlay h2 {
    font-size: 1.2rem;
  }

  .overlay p {
    font-size: 0.85rem;
  }
}

</style>


<!-- STYLES -->
<style>
/* === Hero Animations === */
.hero-img { transition: transform 1.2s ease; }
.hero-overlay { transition: all 1s ease; }
.hero-title { animation: fadeInDown 1s ease forwards; opacity:0; }
.hero-subtitle { animation: fadeInUp 1s 0.5s ease forwards; opacity:0; }

@keyframes fadeInDown { 0% { transform: translateY(-50px); opacity:0; } 100% { transform: translateY(0); opacity:1; } }
@keyframes fadeInUp { 0% { transform: translateY(50px); opacity:0; } 100% { transform: translateY(0); opacity:1; } }

/* === Skills Grid === */
.skill-card { border-radius:15px; overflow:hidden; transition: transform 0.4s ease, box-shadow 0.4s ease; background:#fff; position:relative; }
.skill-card:hover { transform: translateY(-10px) scale(1.03); box-shadow:0 15px 25px rgba(0,0,0,0.2); }
.skill-img-wrapper { height:150px; background: linear-gradient(135deg,#f8f9fa,#e9ecef); display:flex; align-items:center; justify-content:center; position:relative; overflow:hidden; }
.skill-img-wrapper img { max-width:100%; max-height:100%; object-fit:contain; transition: transform 0.4s ease; }
.skill-card:hover .skill-img-wrapper img { transform: scale(1.1); }
.skill-hover-overlay { position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); opacity:0; transition: opacity 0.3s ease; display:flex; align-items:center; justify-content:center; }
.skill-card:hover .skill-hover-overlay { opacity:1; }

/* Explore more card */
.explore-card { background: linear-gradient(135deg,#ff7e5f,#feb47b); color:#fff; font-size:1.1rem; transition: transform 0.3s ease; }
.explore-card:hover { transform: scale(1.05); }

/* Group Photo Animation */
.group-photo .group-img { transition: transform 0.6s ease, filter 0.6s ease; }
.group-photo:hover .group-img { transform: scale(1.05); filter: brightness(1.2); }

/* Reviews Animation */
.review-card { transition: transform 0.3s ease, box-shadow 0.3s ease; }
.review-card:hover { transform: translateY(-5px) scale(1.02); box-shadow:0 10px 20px rgba(0,0,0,0.15); }

.team-card { perspective: 1000px; cursor: pointer; } .team-card .inner { position: relative; width: 100%; height: 220px; transition: transform 0.6s; transform-style: preserve-3d; } .team-card:hover .inner { transform: rotateY(180deg); } .team-card .front, .team-card .back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); } .team-card .front { background: #fff; } .team-card .back { background: #111; color: #fff; transform: rotateY(180deg); }

</style>

<!-- SCRIPT -->
<script>
(function() {
  // Guarded observer for group photo visibility toggle.
  const groupPhoto = document.getElementById('group-photo');
  const teamSection = document.getElementById('about-team');

  if (teamSection && groupPhoto && 'IntersectionObserver' in window) {
    const observer1 = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          groupPhoto.classList.add('hidden'); // we define .hidden in CSS above
        } else {
          groupPhoto.classList.remove('hidden');
        }
      });
    }, { threshold: 0.3 });

    observer1.observe(teamSection);
  } else {
    // fallback behavior: ensure group photo visible if no support or elements missing
    if (groupPhoto) {
      groupPhoto.classList.remove('hidden');
    }
    // No console errors if missing
  }
})();
</script>

{% endblock %}